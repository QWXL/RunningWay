NEW RUN 2025-10-03-22-33-23
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-22-33-23', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-22-38-03
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-22-38-03', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-22-38-44
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-22-38-44', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-22-41-02
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-22-41-02', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-22-52-42
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-22-52-42', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-22-57-17
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-22-57-17', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-02-30
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-02-30', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-03-03
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-03-03', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-19-57
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-19-57', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-25-26
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-25-26', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-29-38
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-29-38', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-35-40
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-35-40', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-38-16
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-38-16', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-40-13
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-40-13', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-43-29
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-43-29', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-44-49
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-44-49', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-03-23-59-05
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-03-23-59-05', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-04-00-05-37
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-04-00-05-37', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-04-00-15-06
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-04-00-15-06', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-04-00-21-30
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-04-00-21-30', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-04-00-24-41
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-04-00-24-41', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-04-00-26-13
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-04-00-26-13', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-04-00-36-21
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-04-00-36-21', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
NEW RUN 2025-10-04-00-49-52
{'load_model': 'out/L12-D768-r010/runningway-init.pth', 'wandb': '', 'proj_dir': 'out/L12-D768-r010', 'random_seed': -1, 'experiment_name': 'runningway_stage1', 'data_file': '/mnt/fd741584-4993-4079-ae43-dfd853280c82/runningway/datasets/data/mini-test_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 4096, 'epoch_steps': 5040, 'epoch_count': 5, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 12, 'n_embd': 768, 'dim_att': 768, 'dim_ffn': 2688, 'lr_init': 1e-05, 'lr_final': 1e-06, 'warmup_steps': 5500, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-06, 'grad_cp': 1, 'weight_decay': 0.001, 'grad_clip': 0.5, 'use_multi_state': True, 'window_size': 1024, 'reset_state_per_batch': False, 'system_prompt_frozen': True, 'state_pool_learning_rate': 0.0001, 'system_ratio': 0.3, 'rnn_ratio': 0.4, 'window_ratio': 0.3, 'use_new_cuda_kernel': False, 'fallback_to_python': True, 'train_stage': 3, 'ds_bucket_mb': 2, 'head_size': 64, 'load_partial': 0, 'magic_prime': 234293, 'my_testing': 'r010', 'my_exit_tokens': 959723409, 'config': 'config.json', 'save_config': None, 'logger': False, 'enable_checkpointing': False, 'default_root_dir': None, 'gradient_clip_val': 0.5, 'gradient_clip_algorithm': None, 'num_nodes': 1, 'num_processes': None, 'devices': '2', 'gpus': None, 'auto_select_gpus': None, 'tpu_cores': None, 'ipus': None, 'enable_progress_bar': True, 'overfit_batches': 0.0, 'track_grad_norm': -1, 'check_val_every_n_epoch': 100000000000000000000, 'fast_dev_run': False, 'accumulate_grad_batches': None, 'max_epochs': -1, 'min_epochs': None, 'max_steps': -1, 'min_steps': None, 'max_time': None, 'limit_train_batches': None, 'limit_val_batches': None, 'limit_test_batches': None, 'limit_predict_batches': None, 'val_check_interval': None, 'log_every_n_steps': 100000000000000000000, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'sync_batchnorm': False, 'precision': 16, 'enable_model_summary': True, 'num_sanity_val_steps': 0, 'resume_from_checkpoint': None, 'profiler': None, 'benchmark': None, 'reload_dataloaders_every_n_epochs': 0, 'auto_lr_find': False, 'replace_sampler_ddp': False, 'detect_anomaly': False, 'auto_scale_batch_size': False, 'plugins': None, 'amp_backend': None, 'amp_level': None, 'move_metrics_to_cpu': False, 'multiple_trainloader_mode': 'max_size_cycle', 'inference_mode': True, 'my_timestamp': '2025-10-04-00-49-52', 'betas': (0.9, 0.99), 'real_bsz': 8, 'run_name': 'RunningWay-12L-768D-multiState'}

RunningWay Configuration:
Multi-State: Enabled
Window Size: 1024
State Ratios: {'system': 0.3, 'rnn': 0.4, 'window': 0.3}
Reset Per Batch: False
Learning Rate: 1e-05 to 1e-06
Weight Decay: 0.001

{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 2000000, 'reduce_bucket_size': 2000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 4, 'gradient_clipping': 0.5, 'fp16': {'enabled': True, 'loss_scale': 0, 'initial_scale_power': 16, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}}
